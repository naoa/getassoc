このメモは, getassocのカタログの管理に関する. 

1. $GETAROOT/etc/index.key
このフィアルは "catalogue.xml" に現れるコーパスの順序を制御する. 
このファイルは1行に1個のハンドル名を含む. ハンドル名がこのファイ
ルに現れるコーパスはこのファイルに現れるのと同じ順で
"catalogue.xml" に現れる. それ以外のコーパスは文字コード順にソー
トされ, "catalogue.xml" の末尾に現れる. 

存在しないコーパスをこのファイルに書いてよい. 無論, それらは無視
される. このファイルの効果はindexの追加および削除を行った時点で
のみ "catalogue.xml" に反映される. 

2. $GETAROOT/etc/catalogue.xml
このファイルはXML形式のindexの一覧である. gss3の
inquirey/catalogueの結果はこのファイルをそのままresultのコンテン
ツとして送信する. このファイルはindexの追加および削除を行った時
点でサーバ上に存在するindexをスキャンすることにより自動的に作成
される. 各indexは, $GETAROOT/dwam/直下に作成されたディレクトリに
格納される. それは, WAM(indexの本体)および, セットアップスクリプ
トが作成した ".inf" というファイルからなる. このファイルは, その
元となるファイル(後述)に, セットアップスクリプトが幾つかの項目を
追加することで作成される. ".inf" ファイル(およびその元となるファ
イル)は "@NAME=VALUE" という形式の複数含んでおり, 各行がコーパス
の1つの属性に対応する. 通常, ".inf" ファイルの元となるファイルに
は "@title=" という形式でそのコーパスのタイトルを入れる. タイト
ルはユーザが見て分かりやすい名前であるべきである. 

".inf" には, セットアップ時に自動的に "@name=" と "@properties="
 の2行が追加される. 前者はindexの名前(すなわちディレクトリ名)で
あり(注1), 後者は作成されたプロパティを ","(コンマ)で区切ってつ
なげたものである. 

さらに, ".inf" ファイルのタイムスタンプを10進数で表したものが, 
created という属性として追加される. これは, ".inf" には現れず, 
"catalogue.xml" にだけ現れる. 

以上, まとめると, 少なくとも以下の4つの属性が ".inf" から
"catalogue.xml" に反映される. 

name="indexの名前"
title="indexの, 人間可読なタイトル"
properties="indexの属性"
created="indexの生成時刻"


注意

"catalogue.xml" はセットアップスクリプトにより自動的に上書きされ
るため, 直接編集してはならない. 

注1: indexのディレクトリ名を変更するとGETAでのハンドル名が変更さ
れる. ところが, ".inf" はGETAの管理外であり, ".inf" の "@name=" 
の部分を編集することが必要である. そもそも, この "@name=" はセッ
トアップスクリプトが自動的に挿入したものであるが, この場合は直接
編集するわけである. また, "catalogue.xml" に反映させる操作も必要
である. 

(普通しないでしょうが, )"catalogue.xml" から, 特定のindexを削除
する(ただし, WAMは残したまま)方法は以下の通りである. 1. 消したい
indexのディレクトリの下にある ".inf" を削除する, またはその 
".inf" の中の "@name=" で始まる行を削除する(この行がないとその
indexは壊れていると判断されるのを逆手に取った操作). 2. indexを
セットアップするか, 消しても困らないindexを削除する. 

".inf" の元となるファイルは, tar形式の場合, ".inf" という拡張子
を持つファイルである. itb形式の場合, itbファイルの先頭にあり, か
つ "@" で始まる行がこれに相当する. 



".inf" の内容はそのまま "catalogue.xml" のcorpusタグの属性に現れ
るため, 重複するエントリを持っていてはならない. 特に, created, 
name, propertiesは自動的に追加されるため, 元となるファイルにこれ
らを含めないよう注意が必要である. 


3. コーパスの属性について

通常のコーパスはタイトルおよび(本文への)リンク情報を持ち, それぞ
れは ".title" ファイル, ".link" ファイル(itb形式では "#title=" 
および "#link=")に格納される. getassoc/sctは文書のタイトルととも
にサムネイルを表示する機能を持っている. サムネイルはタイトルと同
様の形式で画像へのリンクを ".img" ファイル(itb形式では "#img=")
に格納すれば, 自動的にサムネイルが表示されるようになる. また, 
getassoc/gss3ではarticleの属性にこの値が含まれるようになる. なお, 
インストール時のURLの最後の部分は属性の一覧であるため, ここに 
",img" を追加する必要がある. 

単語WAMに属性を加えることは, (GETAではサポートされているが) 
getassocはサポートしていない. 

同様の方法で, ユーザは, ".img" に限らず(予約されていない)属性を
いくつでも追加することができる. 予約されている属性は, 
id, score, name, vec, itb, inf, frq, title, link 
の9つである.

--
$Id: CATALOGUE.TXT,v 1.3 2010/01/28 22:42:20 nis Exp $
